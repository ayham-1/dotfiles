#!/bin/bash

SESSION="$1"
if [ -z "$1" ]; then
	if [ -n "$( tmux ls )" ]; then
		SESSION=$(tmux ls | sed 's/:.*//g' | fzf --height 20% --layout=reverse --prompt "Choose session:" --preview 'tmux ls | grep {}' --preview-window up:1 --print-query | \tail -n1)
	fi
fi

if [ -n "$SESSION" ]; then
	if [ -z "$TMUX" ];then
		tmux attach -t "$SESSION" || tmux new -s "$SESSION"
	else 
		tmux switch-client -t "$SESSION" || tmux -2 new-session -d -s "$SESSION" && tmux switch-client -t "$SESSION"
	fi
fi
